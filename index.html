<html ng-app="app">

<head>
  <title>八仙爆炸事件傷者查詢</title>
  <meta charset="utf-8"></meta>
  <meta name="viewport" content="initial-scale=1" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">
  <!-- Angular Material CSS now available via Google CDN; version 0.10 used here -->
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/0.10.0/angular-material.min.css">
  <!-- md-data-table -->
  <link rel="stylesheet" href="md-data-table.min.css">

  <style>
    [ng-click],
    [data-ng-click],
    [x-ng-click] {
      cursor: pointer;
    }

    a {
      color: blue;
    }

    a:hover {
      text-decoration: underline;
    }

    .primary {
      background: #81C784;
    }

    .info {
      background: #2196F3;
    }

    .success {
      background: #EEFF41;
    }

    .warn {
      background: #F44336;
    }

    .right {
      text-align: right;
    }

    @media screen and (max-width: 479px) {
      td {
        padding: 0 0 0 5px !important;
      }
    }
  </style>
</head>

<body ng-controller="HomeController as vm">
  <md-toolbar layout="row">
    <h2>八仙爆炸事件傷者查詢</h2>
  </md-toolbar>

  <div ng-if="vm.loaded == false">
    <h2>讀取資料中</h2>
  </div>
  <div ng-if="vm.loaded == true">
    <md-content layout="row">
      <md-card flex class="info">
        <md-card-content layout="column">
          <h2 class="md-title">狀況報告</h2>
          <div>
            受傷人數：{{vm.users.length}}
          </div>
          <div>
            重傷：{{(vm.users | filter:{'救護檢傷': '重傷'}).length}} 人
          </div>
          <div>
            出院人數：{{(vm.users | filter:{'即時動向': '出院'}).length}} 人
          </div>
          <div>
            資料來源：<a ng-href="{{vm.source.url}}" target="_blank">{{vm.source.name}}</a>
          </div>
          <div>
            最後更新時間：{{vm.lastmodify}}
          </div>
        </md-card-content>
      </md-card>
      <md-card flex class="warn">
        <md-card-content>
          <h2 class="md-title">提醒</h2>
          <p>
            於臺北市醫院就醫之傷者家屬,若有相關問題,於晚上八點前可撥打社會局社工科電話 02-27206528
          </p>
        </md-card-content>
      </md-card>
    </md-content>

    <md-content>
      <md-input-container md-no-float="">
        <input ng-model="vm.searchText" placeholder="輸入搜尋條件, 例如： 長庚 或是 林文君" ng-change="vm.search()" maxlength="5">
      </md-input-container>

      <md-data-table-container>
        <table md-data-table infinite-scroll='vm.loadMore()' infinite-scroll-distance='2'>
          <tr>
            <td width="20%">
              <b>收治單位</b>
            </td>
            <td width="20%">
              <b>個人資料</b>
            </td>
            <td>
              <b>狀況</b>
            </td>
          </tr>
          <tr ng-repeat="user in vm.result">
            <td width="20%" ng-click="vm.showHospital($event, user['收治單位'])">
              <div layout="column">
                {{user['縣市別']}}
              </div>
              <div layout="column">
                <a ng-if="user.hospital_tel">
                  {{user['收治單位']}}
                </a>
                <span ng-if="!user.hospital_tel" >{{user['收治單位']}}</span>
              </div>
              <div layout="column">
                {{user.hospital_tel}}
              </div>
            </td>
            <td width="20%">
              <span class="md-title">{{user['姓名']}}</span>
              {{user['性別']}}
              <span ng-if="user['年齡']">{{user['年齡']}}歲</span>
              {{user['國籍']}}
            </td>
            <td width="20%">
              <div layout="row">
                <span ng-class="{warn: user['即時動向'] == '加護病房',  info: user['即時動向'] == '轉院'}" ng-if="user['即時動向'] != '其它'">{{user['即時動向']}}</span>
                <span ng-if="user['救護檢傷']" ng-class="{warn: user['救護檢傷'] == '重傷'}">({{user['救護檢傷']}})</span>
              </div>
              <div layout="column" ng-if="user['編號']">
                編號：{{user['編號']}}
              </div>
              <div layout="column" ng-if="user['檢傷編號']">
                <span>檢傷編號: {{user['檢傷編號']}}</span>
              </div>
              <div layout="column" ng-if="user['轉診要求']">
                <span>轉診要求: {{user['轉診要求']}}</span>
              </div>

            </td>
          </tr>
        </table>
      </md-data-table-container>
    </md-content>
  </div>
<a href="https://github.com/koshuang/wounded_search"><img style="position: absolute; top: 0; right: 0; border: 0; z-index: 999;" src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a>

  <!-- Angular Material Dependencies -->
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-animate.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-aria.min.js"></script>


  <!-- Angular Material Javascript now available via Google CDN; version 0.10 used here -->
  <script src="https://ajax.googleapis.com/ajax/libs/angular_material/0.10.0/angular-material.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/1.2.2/fuse.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.9.3/lodash.min.js"></script>

  <script src="ng-infinite-scroll.js"></script>
  <script src="md-data-table.min.js"></script>
  <script src="data.js"></script>
  <script src="app.js"></script>

  <script>
    (function(i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-31366910-1', 'auto');
    ga('send', 'pageview');
  </script>
</body>

</html>
